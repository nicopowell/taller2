@* 
    ================================================================================
    VISTA: MODIFICAR PRESUPUESTO (Edit.cshtml)
    ================================================================================
    CONCEPTO TEÓRICO: Formularios de Edición & Model Binding (TP 8/9)
    
    1. PROPOSITO:
       Permitir al usuario modificar los datos de cabecera de un presupuesto existente.
       
    2. model: Usamos 'PresupuestoViewModel'.
       Esto es vital para que el Model Binding funcione al recibir los datos en el POST
       y para aplicar las validaciones (Data Annotations) definidas en el VM.
*@
@model MVC.ViewModels.PresupuestoViewModel 

@{
    ViewData["Title"] = "Modificar Presupuesto";
}

<h2 class="mt-4">Modificar Presupuesto Nro. @Model.IdPresupuesto</h2>
<hr />

<div class="row">
    <div class="col-md-6">
        @* 
            FORMULARIO (POST a Edit):
            asp-action="Edit": Envía los datos al método [HttpPost] Edit del controlador.
            El ID del presupuesto suele ir también en la URL (ruta) o en el campo oculto.
        *@
        <form asp-action="Edit">
            
            @* 
                VALIDATION SUMMARY:
                Muestra errores generales del modelo que no son específicos de un campo.
                "ModelOnly": Solo muestra errores a nivel de modelo (ej: validaciones de negocio globales).
            *@
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            
            @* 
                ❗ CAMPO OCULTO (HIDDEN) PARA EL ID ❗
                Esto es CRÍTICO en una vista de Edición.
                Necesitamos enviar el ID del presupuesto que estamos modificando de vuelta al controlador.
                Como el usuario no debe editar el ID, lo ponemos 'hidden' (invisible).
                Si falta esto, el 'IdPresupuesto' llegará como 0 al controlador y fallará el UPDATE o dará NotFound.
            *@
            <input type="hidden" asp-for="IdPresupuesto" /> 

            @* GRUPO: NOMBRE DEL DESTINATARIO *@
            <div class="form-group">
                <label asp-for="NombreDestinatario" class="control-label"></label>
                @* 
                    El input vendrá precargado con el valor actual gracias al Tag Helper asp-for.
                    Si el usuario lo deja vacío, se activará la validación [Required] del VM.
                *@
                <input asp-for="NombreDestinatario" class="form-control" />
                <span asp-validation-for="NombreDestinatario" class="text-danger"></span> 
            </div>
            
            @* GRUPO: FECHA DE CREACIÓN *@
            <div class="form-group">
                <label asp-for="FechaCreacion" class="control-label"></label>
                @* 
                    Al tener [DataType(DataType.Date)] en el VM, esto renderiza un input type="date".
                    El navegador mostrará la fecha pre-seleccionada correctamente.
                *@
                <input asp-for="FechaCreacion" class="form-control" /> 
                <span asp-validation-for="FechaCreacion" class="text-danger"></span> 
            </div>
            
            <div class="form-group mt-3">
                <input type="submit" value="Guardar Cambios" class="btn btn-primary" />
            </div>
        </form>
    </div>
</div>

<div class="mt-3">
    @* Enlace para volver al listado sin guardar cambios *@
    <a asp-action="Index">Volver a la lista</a>
</div>

@* 
    SECCIÓN DE SCRIPTS (Validación Cliente):
    Habilita la validación inmediata en el navegador (jQuery Validate)
    para no tener que ir al servidor por errores simples (como campos vacíos).
*@
@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}